task:
  name: "Recovery Build"
  timeout_in: 120m
  container:
      image: ghcr.io/alone0316/docker:arch
      cpu: 8
      memory: 23G
    build:
      env:
        CIRRUS_ARTIFACT_NAME: los-recovery.img
      steps:
        - run: |
            curl https://storage.googleapis.com/git-repo-downloads/repo > ~/bin/repo
            chmod a+x ~/bin/repo
            export PATH=~/bin:$PATH
        - run: ./sync-repo.sh
        - run: ./build-image.sh
        - run: ./upload-artifact.sh
